Code changed for public upload and reference. 
